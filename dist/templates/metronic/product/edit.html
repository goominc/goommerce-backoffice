<div class="page-head">
  <div class="container">
    <div id="contentTitle"></div> <!-- commonly initialized -->
  </div>
</div>
<div class="page-content">
  <div class="container">
    <div id="breadcrumb"></div> <!-- commonly initialized -->
    <div class="page-content-inner">
      <div class="row">
        <div class="col-md-12">
          <div class="portlet light">
            <form class="form-horizontal form-row-seperated">
              <div class="col-md-12">
                <div class="portlet">
                  <div class="portlet-title">
                    <div class="actions btn-set">
                      <button class="btn blue" ng-click="saveAndContinue()"><i class="fa fa-check"></i> {{'main.saveAndContinueButton' | translate}}</button>
                      <button class="btn blue" ng-click="save()"><i class="fa fa-check"></i> {{'main.saveButton' | translate}}</button>
                    </div>
                  </div>
                </div>
              </div>

              <div class="col-md-12">
                <uib-tabset class="tabbable-bordered">
                  <uib-tab heading="{{'product.edit.tabInfo' | translate}}">
                    <!--div class="form-group">
                      <label class="col-md-2 control-label">SKU <span class="required"> * </span> </label>
                      <div class="col-md-10">
                        <input type="text" class="form-control" placeholder="00000-0000" ng-model="product.sku">
                      </div>
                    </div-->
                    <div class="form-group" data-ng-repeat="field in inputFields">
                      <label class="col-md-2 control-label">{{field.title}} <span data-ng-if="field.isRequired" class="required"> * </span> </label>
                      <div class="col-md-10">
                        <input type="text" class="form-control" placeholder="{{field.placeholder}}" ng-model="tmpObj[field.tmpKey]">
                      </div>
                    </div>
                    <div class="form-group">
                      <label class="col-md-2 control-label">{{'product.edit.labelActive' | translate}}</label>
                      <div class="col-md-10">
                        <div class="form-control">
                          <input type="checkbox" id="product_isActive" data-ng-model="product.isActive">
                          <label for="product_isActive"></label>
                        </div>
                      </div>
                    </div>
                    <div class="form-group" data-ng-if="variantKinds">
                      <label class="col-md-2 control-label">{{'product.edit.labelCombination' | translate}}</label>
                      <div class="col-md-10">
                        <div class="col-md-12" style="margin-bottom: 20px;" data-ng-repeat="kind in variantKinds">
                          <div class="col-md-1 control-label">{{kind.name}}</div>
                          <div class="col-md-11">
                            <button class="btn btn-circle default" style="margin-right: 20px;" data-ng-repeat="k in kind.kinds">
                              {{k}} <i data-ng-click="removeVariantKindItem($parent.$index, $index)" class="fa fa-remove"></i>
                            </button>
                            <button class="btn btn-circle default add-item-box">
                              <input type="text" data-ng-blur="addVariantKindItem($index, newObjects.variantKindItem)" ng-keypress="onInputKeypress($event)" data-ng-model="newObjects.variantKindItem"> <i data-ng-click="hideAddItemBox()" class="fa fa-remove"></i>
                            </button>
                            <button class="btn blue add-variant-btn" data-ng-click="clickAddVariantOrItem($event)">
                              <i class="fa fa-plus"></i>
                            </button>
                            <button data-ng-click="removeVariantKind($index)" class="btn red" style="margin-left: 30px;">
                              <i class="fa fa-remove"></i> {{'product.edit.removeVariantKind' | translate}}
                            </button>
                          </div>
                        </div>
                        <div class="col-md-12">
                          <button class="btn btn-circle default add-item-box">
                            <input type="text" data-ng-blur="addVariantKind(newObjects.variantKind)" ng-keypress="onInputKeypress($event)" data-ng-model="newObjects.variantKind"> <i data-ng-click="hideAddItemBox()" class="fa fa-remove"></i>
                          </button>
                          <button class="btn blue add-variant-btn" data-ng-click="clickAddVariantOrItem($event)">
                            <i class="fa fa-plus"></i> {{'product.edit.addVariantKind' | translate}}
                          </button>
                          <button class="btn blue" data-ng-click="generateProductVariants()">
                            규격 상품 생성 <i class="fa fa-angle-down"></i>
                          </button>
                        </div>
                      </div>
                    </div>
                    <div class="form-group">
                      <label class="col-md-2 control-label">{{'product.edit.labelVariant' | translate}}</label>
                      <div class="col-md-10">
                        <table class="table table-bordered dataTable product-variant-table">
                          <thead>
                          <tr role="row" class="heading">
                            <th style="min-width: 150px;">SKU</th>
                            <th width="5%">price</th>
                            <th width="20%">color</th>
                            <th width="20%">size</th>
                            <th width="15%"></th>
                          </tr>
                          </thead>
                          <tbody>
                          <tr>
                            <td><input style="width: 100%; max-width: 300px;" type="text" data-ng-model="newProductVariant.sku" /></td>
                            <td><input type="number" data-ng-model="newProductVariant.KRW" /></td>
                            <td><input type="text" data-ng-model="newProductVariant.data.color" /></td>
                            <td><input type="text" data-ng-model="newProductVariant.data.size" /></td>
                            <td><button class="btn blue" data-ng-click="addProductVariant(newProductVariant)"><i class="fa fa-plus"></i> {{'main.createButton' | translate}}</button></td>
                          </tr>
                          <tr data-ng-repeat="productVariant in productVariants">
                            <td><input style="width: 100%; max-width: 300px;" type="text" data-ng-model="productVariant.sku" /></td>
                            <td><input type="number" data-ng-model="productVariant.KRW" /></td>
                            <td><input type="text" data-ng-model="productVariant.data.color" /></td>
                            <td><input type="text" data-ng-model="productVariant.data.size" /></td>
                            <td><button class="btn red" data-ng-click="removeProductVariant($index)"><i class="fa fa-remove"></i> {{'main.deleteButton' | translate}}</button></td>
                          </tr>
                          </tbody>
                        </table>
                      </div>
                    </div>
                  </uib-tab>
                  <uib-tab heading="{{'product.edit.tabImage' | translate}}" data-ng-click="initImages()">
                    <div class="row">
                      <div class="col-md-12">
                        <button class="btn blue" cl-upload-widget="" callback="imageUploaded(result)"><i class="fa fa-plus"></i> 한 장씩 추가</button>
                        <span class="btn green fileinput-button" style="margin: 15px 0;">
                          <i class="fa fa-plus"></i> 여러 장 추가
                          <input type="file" id="image-upload-button" webkitdirectory directory multiple/>
                        </span>
                        <button class="btn red product-image-trash"><i class="icon-trash"></i></button>
                      </div>
                      <div class="col-md-12" style="margin-top: 20px">
                        <table class="table table-bordered dataTable">
                          <thead>
                          <tr>
                            <th width="20%">SKU</th>
                            <th width="15%">Color</th>
                            <th width="5%">Collapse</th>
                            <th width="10%">SlotCount</th>
                            <th width="50%">Image</th>
                          </tr>
                          </thead>
                          <tbody class="cell-center">
                          <tr data-ng-repeat="row in imageRows">
                            <td style="border-right: 1px solid #e7ecf1;">{{row.sku}}</td>
                            <td data-ng-if="row.rowspan > 0" rowspan="{{row.rowspan}}">
                              {{row.color}}
                            </td>
                            <td data-ng-if="row.rowspan > 0" rowspan="{{row.rowspan}}">
                              <input id="product-image-{{row.sku}}" type="checkbox"
                                     data-ng-if="row.rowspan > 1"
                                     data-ng-model="variantsByColor[row.color].share"
                                     data-ng-change="toggleShare(row.color)"
                              />
                              <label for="product-image-{{row.sku}}"></label>
                            </td>
                            <td data-ng-if="row.imagespan > 0" rowspan="{{row.imagespan}}" style="border-right: 1px solid #e7ecf1;">
                              <input class="product-small-number-input" type="number" min="0" data-ng-model="row.slotCount" />
                            </td>
                            <td data-ng-if="row.imagespan > 0" rowspan="{{row.imagespan}}" class="image-container" ui-sortable="imageSortable" data-ng-model="row.images">
                              <img row-index="{{$parent.$index}}" img-index="{{$index}}" class="image-inline" data-ng-repeat="image in row.images" data-ng-src="{{image.url}}" />
                            </td>
                          </tr>
                          </tbody>
                        </table>
                      </div>
                    </div>
                  </uib-tab>
                  <!--uib-tab heading="{{'product.edit.tabImage' | translate}}">
                    <div class="row">
                      <div class="col-md-12">
                        <button class="btn blue" cl-upload-widget="" callback="imageUploaded(result)"><i class="fa fa-plus"></i> {{'main.addImageButton' | translate}}</button>
                      </div>
                      <div class="col-md-12" style="margin-top: 20px;">
                        <table class="table table-bordered table-hover">
                          <thead>
                          <tr role="row" class="heading">
                            <th>Image</th>
                            <th>Product</th>
                            <th>Main Image</th>
                            <th>Thumbnail</th>
                            <th></th>
                          </tr>
                          </thead>
                          <tbody>
                          <tr data-ng-repeat="image in images">
                            <th width="15%"><a class="fancybox" data-rel="fancybox-button"><img class="img-responsive" data-ng-src="{{image.url}}"></a></th>
                            <th>
                              <div class="dropdown btn-group">
                                <button class="btn btn-default dropdown-toggle" data-toggle="dropdown">{{image.product.sku}}</button>
                                <ul class="dropdown-menu" role="menu">
                                  <li data-ng-click="image.product = product"><a href="javascript:;">{{product.sku}}</a></li>
                                  <li data-ng-click="image.product = productVariant" data-ng-if="productVariant.stock >= 0" data-ng-repeat="productVariant in productVariants"><a href="javascript:;">{{productVariant.sku}}</a></li>
                                </ul>
                              </div>
                              <span><== 상품 지정!</span>
                            </th>
                            <th width="10%"><input id="{{image.mainImage}}" type="checkbox" data-ng-model="image.mainImage"><label for="{{image.mainImage}}"><span></span></label></th>
                            <th width="10%"><input id="{{image.mainImage}}_thumb" type="checkbox" data-ng-model="image.thumbnail"><label for="{{image.mainImage}}_thumb"><span></span></label></th>
                            <th><button class="btn red" type="reset" data-ng-click="removeImage($index)"><i class="fa fa-remove"></i> {{'main.deleteButton' | translate}}</button></th>
                          </tr>
                          </tbody>
                        </table>
                      </div>
                    </div>
                  </uib-tab-->
                  <uib-tab heading="{{'product.edit.tabCategory' | translate}}">
                    <div class="row">
                      <div class="col-md-12">
                        <div class="form-group">
                          <label class="col-md-2 control-label">Categories:
                            <span class="required"> * </span>
                          </label>
                          <div class="col-md-10">
                            <div class="form-control height-auto">
                              <div class="slimScrollDiv" style="position: relative; overflow: hidden; width: auto; height: 275px;"><div class="scroller" style="height: 275px; overflow: scroll; width: auto;" data-always-visible="1" data-initialized="1">
                                <ul class="list-unstyled">
                                  <li data-ng-repeat="category in allCategories.children">
                                    <input type="checkbox" id="category-{{category.id}}"
                                           data-ng-init="category.isChecked = productCategorySet.has(category.id)"
                                           data-ng-model="category.isChecked"
                                           data-ng-checked="productCategorySet.has(category.id)"
                                           data-ng-change="toggleCategory(category.id)"/>
                                    <label for="category-{{category.id}}" data-ng-class="{'checkbox-active': category.isChecked}"></label>
                                    {{ category.name.ko }}
                                    <ul class="list-unstyled">
                                      <li data-ng-repeat="child1 in category.children">
                                        <input type="checkbox" id="category-{{child1.id}}"
                                               data-ng-init="child1.isChecked = productCategorySet.has(child1.id)"
                                               data-ng-model="child1.isChecked"
                                               data-ng-checked="productCategorySet.has(child1.id)"
                                               data-ng-change="toggleCategory(child1.id)"/>
                                        <label for="category-{{child1.id}}" data-ng-class="{'checkbox-active': child1.isChecked}"></label>
                                        {{ child1.name.ko }}
                                        <ul class="list-unstyled">
                                          <li data-ng-repeat="child2 in child1.children">
                                            <input type="checkbox" id="category-{{child2.id}}"
                                                   data-ng-init="child2.isChecked = productCategorySet.has(child2.id)"
                                                   data-ng-model="child2.isChecked"
                                                   data-ng-checked="productCategorySet.has(child2.id)"
                                                   data-ng-change="toggleCategory(child2.id)"/>
                                            <label for="category-{{child2.id}}" data-ng-class="{'checkbox-active': child2.isChecked}"></label>
                                            {{ child2.name.ko }}
                                          </li>
                                        </ul>
                                      </li>
                                    </ul>
                                  </li>
                                </ul>
                              </div></div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </uib-tab>
                </uib-tabset>
              </div>
              <div style="clear: both;"></div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
