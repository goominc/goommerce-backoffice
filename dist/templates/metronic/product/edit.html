<div class="page-head">
  <div class="container">
    <div id="contentTitle"></div> <!-- commonly initialized -->
  </div>
</div>
<div class="page-content">
  <div class="container">
    <div id="breadcrumb"></div> <!-- commonly initialized -->
    <div class="page-content-inner">
      <div class="row">
        <div class="col-md-12">
          <div class="portlet light">
            <form class="form-horizontal form-row-seperated">
              <div class="col-md-12">
                <div class="portlet">
                  <div class="portlet-title">
                    <div class="actions btn-set">
                      <button class="btn blue" ng-click="save()"><i class="fa fa-check"></i> {{'product.save' | translate}}</button>
                    </div>
                  </div>
                </div>
              </div>

              <div class="col-md-12">
                <uib-tabset class="tabbable-bordered">
                  <uib-tab heading="{{'product.edit.tabInfo' | translate}}">
                    <div class="form-group">
                      <label class="col-md-2 control-label">SKU <span class="required"> * </span> </label>
                      <div class="col-md-10">
                        <input type="text" class="form-control ng-pristine ng-untouched ng-invalid ng-invalid-required" placeholder="00000-0000" ng-model="product.sku">
                      </div>
                    </div>
                    <div class="form-group" ng-repeat="field in names">
                      <label class="col-md-2 control-label">{{field.title}} <span class="required"> * </span> </label>
                      <div class="col-md-10">
                        <input type="text" class="form-control ng-pristine ng-untouched ng-invalid ng-invalid-required" placeholder="{{field.placeholder}}" ng-model="product.name[field.key]">
                      </div>
                    </div>
                    <div class="form-group" ng-repeat="field in prices">
                      <label class="col-md-2 control-label">{{field.title}} <span class="required"> * </span> </label>
                      <div class="col-md-10">
                        <input type="text" class="form-control ng-pristine ng-untouched ng-invalid ng-invalid-required" placeholder="{{field.placeholder}}" ng-model="product.price[field.key]">
                      </div>
                    </div>
                    <div class="form-group">
                      <label class="col-md-2 control-label">{{'product.edit.labelActive' | translate}}</label>
                      <div class="col-md-10">
                        <div class="form-control">
                          <input type="checkbox" id="product_isActive" data-ng-model="product.isActive">
                          <label for="product_isActive"></label>
                        </div>
                      </div>
                    </div>
                    <div class="form-group">
                      <label class="col-md-2 control-label">{{'product.edit.labelCombination' | translate}}</label>
                      <div class="col-md-10">
                        <div class="col-md-12" style="margin-bottom: 20px;" data-ng-repeat="kind in variantKinds">
                          <div class="col-md-1 control-label">{{kind.name}}</div>
                          <div class="col-md-11">
                            <button class="btn btn-circle default" style="margin-right: 20px;" data-ng-repeat="k in kind.kinds">
                              {{k}} <i data-ng-click="removeVariantKindItem($parent.$index, $index)" class="fa fa-remove"></i>
                            </button>
                            <button class="btn btn-circle default add-item-box">
                              <input type="text" data-ng-blur="addVariantKindItem($index, newObjects.variantKindItem)" ng-keypress="onInputKeypress($event)" data-ng-model="newObjects.variantKindItem"> <i data-ng-click="hideAddItemBox()" class="fa fa-remove"></i>
                            </button>
                            <button class="btn blue add-variant-btn" data-ng-click="clickAddVariantOrItem($event)">
                              <i class="fa fa-plus"></i>
                            </button>
                            <button data-ng-click="removeVariantKind($index)" class="btn red" style="margin-left: 30px;">
                              <i class="fa fa-remove"></i> {{'product.edit.removeVariantKind' | translate}}
                            </button>
                          </div>
                        </div>
                        <div class="col-md-12">
                          <button class="btn btn-circle default add-item-box">
                            <input type="text" data-ng-blur="addVariantKind(newObjects.variantKind)" ng-keypress="onInputKeypress($event)" data-ng-model="newObjects.variantKind"> <i data-ng-click="hideAddItemBox()" class="fa fa-remove"></i>
                          </button>
                          <button class="btn blue add-variant-btn" data-ng-click="clickAddVariantOrItem($event)">
                            <i class="fa fa-plus"></i> {{'product.edit.addVariantKind' | translate}}
                          </button>
                          <button class="btn blue" data-ng-click="generateProductVariants()">
                            규격 상품 생성 <i class="fa fa-angle-down"></i>
                          </button>
                        </div>
                      </div>
                    </div>
                    <div class="form-group">
                      <label class="col-md-2 control-label">{{'product.edit.labelVariant' | translate}}</label>
                      <div class="col-md-10">
                        <table class="table table-bordered dataTable">
                          <thead>
                          <tr role="row" class="heading">
                            <th>sku</th>
                            <th>price</th>
                            <th>stock</th>
                            <th></th>
                          </tr>
                          </thead>
                          <tbody>
                          <tr>
                          <tr data-ng-class="{'bo-invalid-row': newProductVariant.stock < 0}">
                            <th><input type="text" data-ng-model="newProductVariant.sku" /></th>
                            <th><input type="number" data-ng-model="newProductVariant.price.KRW" /></th>
                            <th><input type="number" data-ng-model="newProductVariant.stock" /></th>
                            <th><button class="btn blue" data-ng-click="addProductVariant(newProductVariant)"><i class="fa fa-plus"></i> {{'main.createButton' | translate}}</button></th>
                          </tr>
                          <tr data-ng-repeat="productVariant in productVariants" data-ng-class="{'bo-invalid-row': productVariant.stock < 0}">
                            <th><input type="text" data-ng-model="productVariant.sku" /></th>
                            <th><input type="number" data-ng-model="productVariant.price.KRW" /></th>
                            <th><input type="number" data-ng-model="productVariant.stock" /></th>
                            <th><button class="btn red" data-ng-click="removeProductVariant($index)"><i class="fa fa-remove"></i> {{'main.deleteButton' | translate}}</button></th>
                          </tr>
                          </tbody>
                        </table>
                      </div>
                    </div>
                  </uib-tab>
                  <uib-tab heading="Images">
                    <div class="row">
                      <div class="col-md-12">
                        <button class="btn blue" cl-upload-widget="" callback="imageUploaded(result)"><i class="fa fa-plus"></i> Add Image</button>
                      </div>
                      <div class="col-md-12" style="margin-top: 20px;">
                        <table class="table table-bordered table-hover">
                          <thead>
                          <tr role="row" class="heading">
                            <th>Image</th>
                            <th>Product</th>
                            <th>Main Image</th>
                            <th>Thumbnail</th>
                            <th></th>
                          </tr>
                          </thead>
                          <tbody>
                          <tr data-ng-repeat="image in images">
                            <th width="15%"><a class="fancybox" data-rel="fancybox-button"><img class="img-responsive" data-ng-src="{{image.url}}"></a></th>
                            <th>
                              <div class="dropdown btn-group">
                                <button class="btn btn-default dropdown-toggle" data-toggle="dropdown">{{image.product.sku}}</button>
                                <ul class="dropdown-menu" role="menu">
                                  <li data-ng-click="image.product = product"><a href="javascript:;">{{product.sku}}</a></li>
                                  <li data-ng-click="image.product = productVariant" data-ng-if="productVariant.stock >= 0" data-ng-repeat="productVariant in productVariants"><a href="javascript:;">{{productVariant.sku}}</a></li>
                                </ul>
                              </div>
                            </th>
                            <th width="10%"><input id="{{image.mainImage}}" type="checkbox" data-ng-model="image.mainImage"><label for="{{image.mainImage}}"><span></span></label></th>
                            <th width="10%"><input id="{{image.mainImage}}_thumb" type="checkbox" data-ng-model="image.thumbnail"><label for="{{image.mainImage}}_thumb"><span></span></label></th>
                            <th><button class="btn red" type="reset" data-ng-click="removeImage($index)"><i class="fa fa-remove"></i> {{'main.deleteButton' | translate}}</button></th>
                          </tr>
                          </tbody>
                        </table>
                      </div>
                    </div>
                  </uib-tab>
                  <uib-tab heading="Category">
                    <div class="row">
                      <div class="col-md-12">
                        <div class="form-group">
                          <label class="col-md-2 control-label">Categories:
                            <span class="required"> * </span>
                          </label>
                          <div class="col-md-10">
                            <div class="form-control height-auto">
                              <div class="slimScrollDiv" style="position: relative; overflow: hidden; width: auto; height: 275px;"><div class="scroller" style="height: 275px; overflow: hidden; width: auto;" data-always-visible="1" data-initialized="1">
                                <ul class="list-unstyled">
                                  <li data-ng-repeat="category in allCategories.children">
                                    <input type="checkbox" id="category-{{category.id}}"
                                           data-ng-init="category.isChecked = productCategorySet.has(category.id)"
                                           data-ng-model="category.isChecked"
                                           data-ng-checked="productCategorySet.has(category.id)"
                                           data-ng-change="toggleCategory(category.id)"/>
                                    <label for="category-{{category.id}}" data-ng-class="{'checkbox-active': category.isChecked}"></label>
                                    {{ category.name.ko }}
                                    <ul class="list-unstyled">
                                      <li data-ng-repeat="child1 in category.children">
                                        <input type="checkbox" id="category-{{child1.id}}"
                                               data-ng-init="child1.isChecked = productCategorySet.has(child1.id)"
                                               data-ng-model="child1.isChecked"
                                               data-ng-checked="productCategorySet.has(child1.id)"
                                               data-ng-change="toggleCategory(child1.id)"/>
                                        <label for="category-{{child1.id}}" data-ng-class="{'checkbox-active': category.isChecked}"></label>
                                        {{ child1.name.ko }}
                                        <ul class="list-unstyled">
                                          <li data-ng-repeat="child2 in child1.children">
                                            <input type="checkbox" id="category-{{child2.id}}"
                                                   data-ng-init="child2.isChecked = productCategorySet.has(child2.id)"
                                                   data-ng-model="child2.isChecked"
                                                   data-ng-checked="productCategorySet.has(child2.id)"
                                                   data-ng-change="toggleCategory(child2.id)"/>
                                            <label for="category-{{child2.id}}" data-ng-class="{'checkbox-active': category.isChecked}"></label>
                                            {{ child2.name.ko }}
                                          </li>
                                        </ul>
                                      </li>
                                    </ul>
                                  </li>
                                </ul>
                              </div></div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </uib-tab>
                </uib-tabset>
              </div>
              <div style="clear: both;"></div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
